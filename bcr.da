Olympus = import_da('olympus')
Replica = import_da('replica')
Client  = import_da('client')

# other configs
config( channel = {'fifo', 'reliable'} )

# the main function to start the environment
def main():
  # parse the config file here as we want to send parameters during setup
  # for now we set values here
  client_count = 1
  fault_tolerance_factor = 20
  replicas_required = 2*fault_tolerance_factor + 1
  client_timeout_value = 180 # in secs
  replica_timeout_value = 120 # in secs

  # create new actors on specified nodes
  olympus     = new( Olympus.Node,                        at='OlympusNode' )
  client      = new( Client.Node , num=client_count,      at='ClientNode'  )
  replica_set = new( Replica.Node, num=replicas_required, at='ReplicaNode' )

  # start olympus
  setup( olympus, (fault_tolerance_factor, replica_set, replica_timeout_value) )
  start( olympus )

  # start client(s)
  setup( client , (olympus,) )
  start( client)
